<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
    <meta name="author" content="Janith">
    <meta name="description" content="Janith's blog">
    <link rel="icon" href="https://janithl.github.io/favicon.ico">

    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Abhaya+Libre:400,700&amp;subset=sinhala">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootswatch/3.3.6/readable/bootstrap.min.css">
    <link rel="stylesheet" type="text/css" href="https://janithl.github.io/theme/css/style.css">
    <link rel="stylesheet" type="text/css" href="https://janithl.github.io/theme/css/pygments.css">

    <title>Janith's Blog &ndash; Kottu Kontainers</title>

<script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-7602960-7']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>

    <link href="https://janithl.github.io/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="Janith's Blog Atom" />

<meta name="keywords" content="code">

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
</head>

<body>
    <nav class="navbar navbar-inverse">
        <div class="container-fluid">
            <div class="navbar-header">
                <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar-collapse">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <a class="navbar-brand" href="https://janithl.github.io/">Janith's Blog</a>
            </div>

            <div class="collapse navbar-collapse" id="navbar-collapse">
                <ul class="nav navbar-nav navbar-right">

                    <li><a href="https://janithl.github.io/pages/about.html">About</a></li>

                    <li class="active"><a href="https://janithl.github.io/category/general/">General</a></li>
                    <li><a href="https://janithl.github.io/category/links/">Links</a></li>
                    <li><a href="https://janithl.github.io/category/personal/">Personal</a></li>

                    <li><a href="https://github.com/janithl" target="_blank">Github</a></li>

                    <li><a href="https://janithl.github.io/archives.html">Archives</a></li>


                    <li class="dropdown">
                      <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Tags <span class="caret"></span></a>
                      <ul class="dropdown-menu">
                          <li><a href="https://janithl.github.io/tag/biology/">biology</a></li>
                          <li><a href="https://janithl.github.io/tag/casey-neistat/">casey neistat</a></li>
                          <li><a href="https://janithl.github.io/tag/code/">code</a></li>
                          <li><a href="https://janithl.github.io/tag/comics/">comics</a></li>
                          <li><a href="https://janithl.github.io/tag/conflict/">conflict</a></li>
                          <li><a href="https://janithl.github.io/tag/conversations/">conversations</a></li>
                          <li><a href="https://janithl.github.io/tag/data/">data</a></li>
                          <li><a href="https://janithl.github.io/tag/design/">design</a></li>
                          <li><a href="https://janithl.github.io/tag/education/">education</a></li>
                          <li><a href="https://janithl.github.io/tag/films/">films</a></li>
                          <li><a href="https://janithl.github.io/tag/geopolitics/">geopolitics</a></li>
                          <li><a href="https://janithl.github.io/tag/machine-learning/">machine learning</a></li>
                          <li><a href="https://janithl.github.io/tag/music/">music</a></li>
                          <li><a href="https://janithl.github.io/tag/oasis/">oasis</a></li>
                          <li><a href="https://janithl.github.io/tag/people/">people</a></li>
                          <li><a href="https://janithl.github.io/tag/politics/">politics</a></li>
                          <li><a href="https://janithl.github.io/tag/prudishness/">prudishness</a></li>
                          <li><a href="https://janithl.github.io/tag/religion/">religion</a></li>
                          <li><a href="https://janithl.github.io/tag/sexuality/">sexuality</a></li>
                          <li><a href="https://janithl.github.io/tag/sinhala/">sinhala</a></li>
                          <li><a href="https://janithl.github.io/tag/travel/">travel</a></li>
                          <li><a href="https://janithl.github.io/tag/uni/">uni</a></li>
                          <li><a href="https://janithl.github.io/tag/wes-anderson/">wes anderson</a></li>
                          <li><a href="https://janithl.github.io/tag/work/">work</a></li>
                      </ul>
                    </li>

                    <li><a href="https://janithl.github.io/feeds/all.atom.xml">Atom</a></li>
                </ul>
            </div>
        </div>
    </nav>
    <div class="container">
<article>
  <div class="article_title">
    <h3><a href="https://janithl.github.io/2019/02/kottu-kontainers/">Kottu Kontainers</a></h3>
    <p class="lead">Using Docker Compose for fun and profit</p><hr>
  </div>
  <div class="article_text">
    <p>Remember <a href="https://kottu.org">Kottu</a>? Those were the days. Anyway,
<a href="https://github.com/janithl/Kottu2012">Kottu has always been a totally open-source project</a>, and theoretically
it is as easy as cloning the git repo and... jumping a few hoops to set it
up on your own local machine or VPS.</p>
<p>Except... the loops are tedious and there’s a bunch of things that could go
wrong. There must be a better way, right?</p>
<p>Enter <a href="https://www.docker.com">Docker</a>. It promises to solve one of the oldest complaints in
Computer Science, namely "it works on <em>my</em> machine". I’ve been using Docker
at work for the past 6 months (hat tip to the wonderful <a href="https://github.com/malitta">Malitta Nanayakkara</a>
for getting me the job AND teaching me the basics of Docker) and my mind has
been simply blown away by how simple and effective it is, and how I barely
have to think about dependencies and reproducible environments anymore.</p>
<p>I won't get into the background of Docker and how it works, but there’s this
<a href="https://towardsdatascience.com/learn-enough-docker-to-be-useful-b7ba70caeb4b">wonderful series by Jeff Hale if you’re so inclined</a>.</p>
<h3>Step 1: Clone the Repo</h3>
<p>It’s been almost over 2 years since I last messed with the Kottu source code,
so it’s naturally no longer on my machine. I run a git clone and download the
repo.</p>
<p>I look through the instructions and they basically go like “run kottu.sql on
the mysql server which you *obviously* have running on your machine
(<code>#LAMPBoise</code>) and then copy this into your webroot, update the config, and bam!
Kottu for the whole kadey!”.</p>
<p>But we’re in 2019 and no one is stupid enough to run mysql and Apache on their
machines like that. I’m not even on Linux anymore! (<strong>the HORROR</strong>! 21 year old
me writing Kottu would’ve spit in disgust if he knew I use a Mac now.)</p>
<h3>Step 2: Look around the web for a docker-compose.yml file to hijack</h3>
<p>No one <em>writes</em> software anymore, we just copy paste snippets from a thousand
blog posts and StackOverflow answers, cobble it together, and pray it works.</p>
<p>I found two articles on this setup, one from <a href="https://www.digitalocean.com/community/tutorials/how-to-set-up-laravel-nginx-and-mysql-with-docker-compose">DigitalOcean</a> (excellent
resource) which is a bit Laravel-focused, and one from the
<a href="http://geekyplatypus.com/dockerise-your-php-application-with-nginx-and-php7-fpm">Geeky Platypus blog</a> which was more generic. Kottu is custom PHP, and the
Geeky Platypus <code>docker-compose.yml</code> file was cleaner, so I used it as the base
with some bits pulled from the DigitalOcean guide. Note that both use nginx and
not Apache because we’re civilised human beings nowadays.</p>
<div class="highlight"><pre><span></span><span class="nt">version</span><span class="p">:</span> <span class="s">&quot;2&quot;</span>

<span class="nt">services</span><span class="p">:</span>
  <span class="nt">webserver</span><span class="p">:</span>
    <span class="nt">image</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">nginx:alpine</span>
    <span class="nt">ports</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="s">&quot;8000:80&quot;</span>
    <span class="nt">volumes</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">.:/var/www</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">./docker/nginx/site.conf:/etc/nginx/conf.d/default.conf</span>
    <span class="nt">networks</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">internal</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">default</span>
  <span class="nt">db</span><span class="p">:</span>
    <span class="nt">image</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">mysql:5.7</span>
    <span class="nt">ports</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="s">&quot;3306:3306&quot;</span>
    <span class="nt">environment</span><span class="p">:</span>
      <span class="nt">MYSQL_DATABASE</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">kottu</span>
      <span class="nt">MYSQL_ROOT_PASSWORD</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">your_mysql_root_password</span>
    <span class="nt">volumes</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">./docker/dbdata:/var/lib/mysql/</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">./docker/mysql/my.cnf:/etc/mysql/my.cnf</span>
    <span class="nt">networks</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">internal</span>
  <span class="nt">php</span><span class="p">:</span>
    <span class="nt">image</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">php:5.6-fpm</span>
    <span class="nt">build</span><span class="p">:</span>
      <span class="nt">context</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">.</span>
      <span class="nt">dockerfile</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">./docker/php/Dockerfile</span>
    <span class="nt">volumes</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">.:/var/www</span>
    <span class="nt">networks</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">internal</span>

<span class="nt">networks</span><span class="p">:</span>
  <span class="nt">internal</span><span class="p">:</span>
    <span class="nt">driver</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">bridge</span>
  <span class="nt">default</span><span class="p">:</span>
    <span class="nt">driver</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">host</span>
</pre></div>


<p>Okay, there’s a bit to digest here:</p>
<p>We’re creating three services that work together, namely webserver, php and db.
The webserver is straight up garden variety nginx running on Alpine Linux, which
is very popular for Docker images because of the tiny size. It is exposing port
<code>8000</code> (traditional Kottu port) on Localhost, and directing traffic from there
to the standard <code>80</code> port.</p>
<p>The root directory of the repo is being mounted on <code>/var/www</code>, and a nginx conf
file we have inside our Docker folder is being set as the <code>default.conf</code> for
nginx. More on this conf file (and networking) later.</p>
<p>The db service is based on a standard <code>mysql 5.7</code> image<sup id="fnref:1"><a class="footnote-ref" href="#fn:1">1</a></sup>, exposing the
standard mysql port of <code>3306</code>, and with some env variables for setting the
database name and root password. We also mount a conf file and a data folder
so that database data is persisted across container restarts (internal container
data is by definition ephemeral, so if we don’t do this we will lose our data
if the container is ever down’d).</p>
<p>The php service also has the repo root mounted to <code>/var/www</code> (so that that most
important mama of all files, <code>index.php</code> can be accessed), but there are some
additional dependencies we want to install not included in the standard
<code>php:5.6-fpm</code> image it is based on, so we include a custom <code>Dockerfile</code> (more
on that later). The DigitalOcean guide has port <code>9000</code> being exposed by the php
container and everything, but I found that was unnecessary (and the Geeky
Platypus doesn’t use it either) so we don’t use that here.</p>
<h3>Step 3: Networking</h3>
<p>I’ve skipped talking about networking because networking in Docker deserves its
own blog post, really. The example in the setup we have above, though, is a good
starting point to talk about the amazeballs planet that is Docker networking.<sup id="fnref:2"><a class="footnote-ref" href="#fn:2">2</a></sup></p>
<p>Now, it is standard knowledge that not all services should be exposed to the
public internet. Ideally, we’d only expose things like SSH and the webserver
to incoming traffic. Everything else traditionally sits behind a firewall. With
this Docker Compose setup though, we have created two different networks which
serve our purpose much better than any finicky firewall rules would.</p>
<p><img alt="Networking" src="https://janithl.github.io/images/kottu/networking.png"></p>
<p class="text-center">Internet traffic can enter the default network and hence
nginx, but it cannot enter the internal network.</p>

<p>In our dual-network setup, internet traffic can access nginx through the external
(default) network (which uses the host driver, which allows it to 
<a href="https://docs.docker.com/network/network-tutorial-host">bind directly to the Docker host’s network</a>), but cannot access the internal
bridge network. nginx, which sits on both the default and internal networks, can
use the internal network to communicate with php and mysql.</p>
<p>Note that this works for HTTP traffic (as our nginx container only exposes port
<code>80</code>), but on the server you might use something like
<a href="https://github.com/JrCs/docker-letsencrypt-nginx-proxy-companion">docker-letsencrypt-nginx-proxy-companion</a> to make life easier (and support
HTTPS). It takes care of SSL certs and all that. You will have to replace the
default network in the compose file with the nginx-proxy network, attach the
webserver service to it, and add the <code>VIRTUAL_HOST</code>, <code>LETSENCRYPT_HOST</code>, 
<code>LETSENCRYPT_EMAIL</code> env variables to make proxy companion pick up the hostname
and the certificates you need.</p>
<h3>Step 4: PHP Dockerfile</h3>
<p>We need to install the mysql client and the <code>PDO_Mysql</code> PHP extension on the php
service, so we’ll create a Dockerfile for that.</p>
<div class="highlight"><pre><span></span>FROM php:5.6-fpm

# install dependencies
RUN apt-get update &amp;&amp; apt-get install -y mysql-client

# install php extensions
RUN docker-php-ext-install pdo_mysql
</pre></div>


<p>I later found out that none of the images on Kottu were showing up and it’s because
Timthumb (yes, Kottu <em>still</em> uses Timthumb, please don’t hack us!) needs <code>GD</code>, which
wasn’t installed. So let’s add those lines to the file too:</p>
<div class="highlight"><pre><span></span># Install GD and it&#39;s dependencies

RUN apt-get update &amp;&amp; apt-get install -y \
libfreetype6-dev \
libjpeg62-turbo-dev \
libpng-dev \
&amp;&amp; docker-php-ext-install -j$(nproc) iconv \
&amp;&amp; docker-php-ext-configure gd --with-freetype-dir=/usr/include/ --with-jpeg-dir=/usr/include/ \
&amp;&amp; docker-php-ext-install -j$(nproc) gd
</pre></div>


<h3>Step 5: The mysql and nginx conf files</h3>
<p><code>my.cnf</code> is so basic that it doesn’t even deserve mentioning, but obviously you can
add more configurations here:</p>
<div class="highlight"><pre><span></span>[mysqld]
general_log = 1
general_log_file = /var/lib/mysql/general.log
</pre></div>


<p>The <code>site.conf</code> file for nginx is your standard nginx + php site config:</p>
<div class="highlight"><pre><span></span><span class="k">server</span> <span class="p">{</span>
    <span class="kn">listen</span> <span class="mi">80</span><span class="p">;</span>
    <span class="kn">index</span> <span class="s">index.php</span> <span class="s">index.html</span><span class="p">;</span>
    <span class="kn">server_name</span> <span class="s">localhost</span><span class="p">;</span>
    <span class="kn">error_log</span>  <span class="s">/var/log/nginx/error.log</span><span class="p">;</span>
    <span class="kn">access_log</span> <span class="s">/var/log/nginx/access.log</span><span class="p">;</span>
    <span class="kn">root</span> <span class="s">/var/www</span><span class="p">;</span>

    <span class="kn">location</span> <span class="s">/</span> <span class="p">{</span>
        <span class="kn">try_files</span> <span class="nv">$uri</span> <span class="nv">$uri/</span> <span class="s">/index.php</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kn">location</span> <span class="p">~</span> <span class="sr">\.php$</span> <span class="p">{</span>
        <span class="kn">try_files</span> <span class="nv">$uri</span> <span class="p">=</span><span class="mi">404</span><span class="p">;</span>
        <span class="kn">fastcgi_split_path_info</span> <span class="s">^(.+\.php)(/.+)</span>$<span class="p">;</span>
        <span class="kn">fastcgi_pass</span> <span class="n">php</span><span class="p">:</span><span class="mi">9000</span><span class="p">;</span>
        <span class="kn">fastcgi_index</span> <span class="s">index.php</span><span class="p">;</span>
        <span class="kn">include</span> <span class="s">fastcgi_params</span><span class="p">;</span>
        <span class="kn">fastcgi_param</span> <span class="s">SCRIPT_FILENAME</span> <span class="nv">$document_root$fastcgi_script_name</span><span class="p">;</span>
        <span class="kn">fastcgi_param</span> <span class="s">PATH_INFO</span> <span class="nv">$fastcgi_path_info</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>


<p>It tells nginx to listen for traffic on port 80, make <code>/var/www</code> the web root, try to
find static files for the paths that visitors are trying to access, and then redirect
those requests to <code>index.php</code> if that fails, and pass php requests to <code>php:9000</code> (which
means port <code>9000</code> in the php service).</p>
<h3>Step 6: Rock ’n’ Roll</h3>
<p>We now get to say the magic words:</p>
<div class="highlight"><pre><span></span>docker-compose up -d
</pre></div>


<p><img alt="Containers Starting" src="https://janithl.github.io/images/kottu/containers-starting.png"></p>
<p class="text-center">Ah, satisfaction...</p>

<p>After the images and dependencies are downloaded and the containers are set up, a
<code>docker ps</code><sup id="fnref:3"><a class="footnote-ref" href="#fn:3">3</a></sup> will reveal that three new containers have spun up and we’re ready
to roll. We direct our web browser to <code>localhost:8000</code>, and...</p>
<p><img alt="Database Issue" src="https://janithl.github.io/images/kottu/database-issue.png"></p>
<p class="text-center">Victo- <em>oh god!</em></p>

<p>Whoops, we still need to import the database. But fear not, that’s pretty easy.</p>
<div class="highlight"><pre><span></span>docker-compose exec php bash
root@3836dc148c6a:/var/www/html# cd ..
root@3836dc148c6a:/var/www# ls
LICENSE  README.md  cache  config.php  docker  docker-compose.yml  html  img  index.php  kottu.sql  lib  static  templates  webcache
root@3836dc148c6a:/var/www# mysql -h db -u root -pyour_mysql_root_password kottu &lt; kottu.sql
</pre></div>


<p>I just bash’d into the container, ran the mysql client<sup id="fnref:4"><a class="footnote-ref" href="#fn:4">4</a></sup> (remember installing that
via the Dockerfile earlier?) and redirected <code>kottu.sql</code> (which holds the database
schema) into it. Now, things still look empty but not broken:</p>
<p><img alt="Empty Kottu" src="https://janithl.github.io/images/kottu/empty-kottu.png"></p>
<p class="text-center">Did you guys know that Flickr still exists?</p>

<h3>Step 7: Add a blog and fetch its posts</h3>
<p>Let’s go to the Kottu Baas admin interface, which most people haven’t seen. Get
ready for some Web 2.0 super secure shit, yo.</p>
<p><img alt="Admin Login" src="https://janithl.github.io/images/kottu/admin-login.png"></p>
<p class="text-center">Like all great login forms from 2012, the password is
SHA-1 hashed on the clientside itself! SEKURITEEH.</p>

<p>After entering the default username/password combo of indi/indi, we are inside
the <em>uh-may-zin</em> admin interface:</p>
<p><img alt="Admin Interface" src="https://janithl.github.io/images/kottu/admin-interface.png"></p>
<p>We click “add a blog” and a <strong>POPUP</strong> shows up! How wizard is that?</p>
<p><img alt="Adding Blogs" src="https://janithl.github.io/images/kottu/add-blog.png"></p>
<p class="text-center">The copyright being stuck in 2012 is just apt!</p>

<p>In my bout of narcissism, I add my own blog and navigate to
<code>localhost:8000/admin/feedget/&lt;secretkey&gt;</code>, and voila:</p>
<p><img alt="Fetching Feeds" src="https://janithl.github.io/images/kottu/fetching-feeds.png"></p>
<p class="text-center">backendsecretkeywithunicorns! SEKURITEEH.</p>

<p>Aaaand, finally:</p>
<p><img alt="Kottu working" src="https://janithl.github.io/images/kottu/kottu-working.png"></p>
<p class="text-center">Even Timthumb works, uguise. :')</p>

<p>And there we have it. Now you’ve got your own piece of 2012 tech running a
personalised version of Kottu on Docker! Next week, we cover how Kubern—<sup id="fnref:5"><a class="footnote-ref" href="#fn:5">5</a></sup></p>
<p class="text-center text-muted">* * *</p>

<p>Okay, this post isn’t the most comprehensible piece of writing I’ve done. It
feels rushed and under-explained, and yet resulted in a very long post. The
topics covered honestly require blog posts of their own, and time permitting,
I would do one or two over the course of the year. But here’s a start. And it
feels like a Friday night (and half of Saturday) well-spent setting up an ancient
piece of code on Docker<sup id="fnref:6"><a class="footnote-ref" href="#fn:6">6</a></sup>, so that it becomes at least a tad more accessible.</p>
<p>I think I need to attach a fair warning: <strong>DON’T RUN THIS IN PROD, FOLKS</strong>. It’s
from 2012 and has security holes the size of the Mariana Trench in it, and it’s
a miracle that kottu.org still continues to run<sup id="fnref:7"><a class="footnote-ref" href="#fn:7">7</a></sup>.</p>
<hr>
<p><a href="https://medium.com/@janithl/kottu-kontainers-c3c9833ecf65"><em>Originally Posted on Medium</em></a></p>
<div class="footnote">
<hr>
<ol>
<li id="fn:1">
<p>Another really cool thing about Docker that I missed mentioning in the post
is the ability to run different versions of, say, mysql or php (as your apps
need them) on different containers. This is really helpful if you have a bunch
of old code that can only run on an older version of php/python/whatever...&#160;<a class="footnote-backref" href="#fnref:1" title="Jump back to footnote 1 in the text">&#8617;</a></p>
</li>
<li id="fn:2">
<p>Docker networking is seriously amazing, and they do things like adding
iptables records to make it possible. I would recommend reading the
<a href="https://docs.docker.com/network/">Network section</a> of the Docker docs.&#160;<a class="footnote-backref" href="#fnref:2" title="Jump back to footnote 2 in the text">&#8617;</a></p>
</li>
<li id="fn:3">
<p>Docker has some really cool commands that help you administer everything.
Some of my favourites are:</p>
<p><code>docker ps</code> — lists all the running containers</p>
<p><code>docker stats</code> — container stats</p>
<p><code>docker-compose logs -f</code> — logs from all the containers in the compose file</p>
<p><code>docker network ls</code> — lists networks&#160;<a class="footnote-backref" href="#fnref:3" title="Jump back to footnote 3 in the text">&#8617;</a></p>
</li>
<li id="fn:4">
<p>A sharp-eyed reader might ask: "why not just run the mysql client from the
<code>exec</code> command?". Well, I tried that and it gives some weird tty error that
I remember once solving, but I forgot how. This bash/mysql method described
here works without issue.&#160;<a class="footnote-backref" href="#fnref:4" title="Jump back to footnote 4 in the text">&#8617;</a></p>
</li>
<li id="fn:5">
<p>This is a joke. I don't know Kubernetes. Who does, really? <code>¯\_(ツ)_/¯</code>&#160;<a class="footnote-backref" href="#fnref:5" title="Jump back to footnote 5 in the text">&#8617;</a></p>
</li>
<li id="fn:6">
<p>I updated the repo and its README with how to do a Docker setup!&#160;<a class="footnote-backref" href="#fnref:6" title="Jump back to footnote 6 in the text">&#8617;</a></p>
</li>
<li id="fn:7">
<p>Hat tip to the mysterious maintainer who set up nginx and LetsEncrypt SSL
certs on the Kottu server!</p>
<p><strong>Update:</strong> Turns out it was trusty ol' <a href="https://github.com/malinthe">Malinthe</a>!&#160;<a class="footnote-backref" href="#fnref:7" title="Jump back to footnote 7 in the text">&#8617;</a></p>
</li>
</ol>
</div>
  </div>
  <div class="article_meta">
    <p>Posted on: Sat 02 February 2019</p>
    <p>Category: <a href="https://janithl.github.io/category/general/">General</a>
 &ndash; Tags:
      <a href="https://janithl.github.io/tag/code/">code</a>    </p>
  </div>

  <div id="article_comments">
    <div id="disqus_thread"></div>
    <script type="text/javascript">
        var disqus_identifier = "2019/02/kottu-kontainers/";
        (function() {
             var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
             dsq.src = '//janithl.disqus.com/embed.js';
             (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
         })();
    </script>
  </div>

</article>

    </div>

    <div id="ending_message">
        <hr>
        <p>Built using <a href="http://getpelican.com" target="_blank">Pelican</a>.</p>
    </div>

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js"></script>
</body>
</html>